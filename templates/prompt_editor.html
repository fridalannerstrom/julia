{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Julia</title>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link rel="stylesheet" href="{% static 'css/style.css' %}">
        <link rel="icon" type="image/x-icon" href="{% static 'assets/favicon.ico' %}">
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
            <div class="container px-4">
                <a class="navbar-brand" href="#page-top">Julia AI</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link" href="{% url 'index' %}">Verktyget</a></li>
                        <li class="nav-item"><a class="nav-link active text-white" href="{% url 'prompt_editor' %}">√Ñndra prompts</a></li>
                        <li class="nav-item"><a class="nav-link" href="{% url 'chat_home' %}">Chatt</a></li>
                    </ul> 
                </div>
            </div>
        </nav>

        <!-- Header-->
        <header class="bg-primary bg-gradient text-white">
            <div class="container px-4 text-center">
                <h1 class="fw-bolder">Domarn√§mnden ‚Äì Prompts</h1>
            </div>
        </header>

        <!-- Content -->
        <section id="about">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8">

                        <h2 class="adminui-title" style="margin-top:24px;">Redigera AI-instruktioner</h2>
                        <p>
                            H√§r styr du hur Julia AI tolkar testresultat och intervjuanteckningar, samt hur
                            analyserna skrivs ut i rapporten.
                        </p>

                        <div class="adminui-assessment-box" style="font-size:0.9rem; margin-bottom:24px;">
                            <b>Tillg√§ngliga taggar:</b><br>
                            <code>{excel_text}</code> ‚Äì r√•data/utdrag fr√•n Excelfilen.<br>
                            <code>{intervju_text}</code> ‚Äì intervjuanteckningar (rensade/samlade).<br>
                            <code>{tq_fardighet_text}</code>, <code>{tq_motivation_text}</code>,
                            <code>{leda_text}</code>, <code>{mod_text}</code>,
                            <code>{sjalkannedom_text}</code>, <code>{strategi_text}</code>,
                            <code>{kommunikation_text}</code> ‚Äì anv√§nds i sammanfattande prompts.<br>
                            <code>{sur_text}</code> ‚Äì texten med styrkor/utvecklingsomr√•den/riskbeteenden.
                            <br><br>
                            <b>Viktigt:</b> ta inte bort taggarna i klamrar om du vill att r√§tt inneh√•ll ska f√∂ras in automatiskt.
                        </div>

                        <form method="post">
                            {% csrf_token %}

                            {# ===== SEKTION 1: Tolkning av Excelfil ===== #}
                            {% for prompt in prompts %}
                                {% if prompt.name == "tolka_excel_resultat" %}
                                    <div class="adminui-container" style="margin-bottom:32px;">
                                        <h3 class="adminui-subtitle">1. Tolkning av Excelfil (betygstabeller)</h3>
                                        <p class="adminui-help" style="font-size:0.9rem;">
                                            Denna prompt styr hur AI:n ska l√§sa Excelfilen och omvandla testresultaten
                                            till betyg (1‚Äì5) i kompetenstabellerna.
                                            <br>
                                            Rekommendation:
                                            <ul style="padding-left:18px; margin-top:4px;">
                                                <li>F√∂rklara hur kolumner/rader motsvarar kompetenser.</li>
                                                <li>Beskriv hur decimaler ska avrundas (t.ex. 2,2 ‚Üí 2, 2,7 ‚Üí 3).</li>
                                                <li>Be AI:n att returnera en ren JSON-struktur som systemet kan l√§sa.</li>
                                            </ul>
                                            Taggar som kan anv√§ndas h√§r: <code>{excel_text}</code>.
                                        </p>
                                        <textarea
                                            name="prompt_{{ prompt.name }}"
                                            rows="10"
                                            class="adminui-textarea"
                                        >{{ prompt.text }}</textarea>
                                    </div>
                                {% endif %}
                            {% endfor %}

                            {# ===== SEKTION 2: √ñvriga prompts ===== #}
                            <div class="adminui-container" style="margin-bottom:16px;">
                                <h3 class="adminui-subtitle">2. √ñvriga prompts</h3>
                                <p class="adminui-help" style="font-size:0.9rem; margin-bottom:16px;">
                                    Dessa styr hur analyserna formuleras baserat p√• testdata, intervjuanteckningar
                                    och tidigare genererade texter. Anpassa ton, l√§ngd och fokus efter Domarn√§mndens behov.
                                </p>

                                {% for prompt in prompts %}
                                    {% if prompt.name != "tolka_excel_resultat" %}
                                        <div style="margin-bottom:24px;">
                                            <label for="prompt_{{ prompt.name }}" class="adminui-label">
                                                {{ prompt.name|capfirst }}
                                            </label>
                                            <p style="font-size:0.8rem; color:#666; margin-bottom:4px;">
                                                √Ñndra med f√∂rsiktighet. Beh√•ll relevanta taggar (t.ex. <code>{excel_text}</code>, <code>{intervju_text}</code>).
                                            </p>
                                            <textarea
                                                id="prompt_{{ prompt.name }}"
                                                name="prompt_{{ prompt.name }}"
                                                rows="6"
                                                class="adminui-textarea"
                                            >{{ prompt.text }}</textarea>
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>

                            <button type="submit" class="adminui-button">
                                üíæ Spara √§ndringar
                            </button>
                        </form>

                    </div>
                </div>
            </div>
        </section>

        <!-- Footer-->
        <footer class="py-5 bg-dark">
            <div class="container px-4">
                <p class="m-0 text-center text-white">Copyright &copy; TQ Nordic</p>
            </div>
        </footer>

        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="{% static 'js/script.js' %}"></script>
    </body>
</html>
