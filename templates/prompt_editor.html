{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Julia</title>

    <!-- Bootstrap CSS (samma som p√• verktygssidan) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Din egna styles -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="icon" href="{% static 'img/favicon.ico' %}">
</head>

<body id="page-top">
  <div class="app-shell">

    <!-- SIDEBAR (samma som p√• verktygssidan, men med aktiv l√§nk p√• √Ñndra prompts) -->
    <aside class="sidebar">
      <div class="sidebar-brand">
        <span class="brand-dot"></span>
        <span class="brand-text">Julia AI</span>
      </div>

      <nav class="sidebar-nav">
        <a href="{% url 'index' %}" class="sidebar-link">
          <span class="sidebar-icon">‚öôÔ∏è</span>
          <span>Verktyget</span>
        </a>
        <a href="{% url 'prompt_editor' %}" class="sidebar-link sidebar-link-active">
          <span class="sidebar-icon">üìù</span>
          <span>√Ñndra prompts</span>
        </a>
        <a href="{% url 'chat_home' %}" class="sidebar-link">
          <span class="sidebar-icon">üí¨</span>
          <span>Chatt</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <div class="user-chip">
          <div class="user-avatar">
            {{ user.first_name|default:"J" |first }}
          </div>
          <div class="user-meta">
            <span>Inloggad som</span>
            <strong>{{ user.get_full_name|default:"G√§st" }}</strong>
          </div>
        </div>
        <button class="logout-btn" type="button">
          Logga ut
        </button>
        <p class="sidebar-copy">¬© TQ Nordic</p>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-area">
      <header class="page-header">
        <div>
          <h1>Hej {{ user.first_name|default:user.username }} üëã</h1>
          <p>Uppdatera AI-instruktioner f√∂r Domarn√§mnden.</p>
        </div>
        <div class="page-header-meta">
          <span class="pill">Domarn√§mnden</span>
          <span class="pill pill-soft">Prompts</span>
        </div>
      </header>

      <section id="about">
        <div class="adminui-layout">
          <div class="adminui-main">
            <div class="adminui-container">

              <h2 class="adminui-title" style="margin-top:0;">Redigera AI-instruktioner</h2>
              <p class="adminui-intro">
                H√§r styr du hur Julia AI tolkar testresultat, intervjuanteckningar och hur
                rapportens olika delar formuleras. Uppdelat i tre tydliga sektioner.
              </p>

              <form method="post">
                {% csrf_token %}

                {# ===== SEKTION 1: Excelfil ‚Äì teknisk struktur ===== #}
                {% for prompt in prompts %}
                  {% if prompt.name == "tolka_excel_resultat" %}
                    <div class="adminui-container" style="margin-bottom:32px;">
                      <h3 class="adminui-subtitle">1. Tolkning av Excelfil (teknisk struktur)</h3>
                      <p class="adminui-help" style="font-size:0.9rem;">
                        Denna prompt beskriver hur Excelfilen √§r <b>uppbyggd</b> och vad varje
                        kolumn betyder. I nuvarande version anv√§nds tolkningen i f√∂rsta hand i
                        programmets Python-kod, men texten kan ligga kvar h√§r som dokumentation.
                        <br><br>
                        <span style="color: red;">√Ñndra endast om Excelformat eller kolumnnamn √§ndras.</span>
                      </p><br>
                      <textarea
                        name="prompt_{{ prompt.name }}"
                        rows="8"
                        class="adminui-textarea"
                      >{{ prompt.text }}</textarea>
                    </div>
                  {% endif %}
                {% endfor %}
<hr>
                {# ===== SEKTION 2: Betygsskala ‚Äì betydelsen av niv√•erna ===== #}
                {% for prompt in prompts %}
                  {% if prompt.name == "betygsskala_forklaring" %}
                    <div class="adminui-container" style="margin-bottom:32px;">
                      <h3 class="adminui-subtitle">2. Betygsskala: Vad betyder niv√•erna 1‚Äì5?</h3>
                      <p class="adminui-help" style="font-size:0.9rem;">
                        Denna prompt b√∂r anv√§nds i alla bed√∂mningssteg. H√§r beskriver du hur AI:n ska
                        tolka po√§ng p√• skalan 1‚Äì5, b√•de generellt och (valfritt) specifikt f√∂r
                        varje kompetens. Detta s√§kerst√§ller konsekvent tolkning i rapporterna.
                      </p><br>
                      <textarea
                        name="prompt_{{ prompt.name }}"
                        rows="12"
                        class="adminui-textarea"
                      >{{ prompt.text }}</textarea>
                    </div>
                  {% endif %}
                {% endfor %}

                {# ===== SEKTION 3: √ñvriga prompts ‚Äì analyser & slutsatser ===== #}
                <div class="adminui-container" style="margin-bottom:16px;">
                  <h3 class="adminui-subtitle">3. √ñvriga prompts (analyser och slutsatser)</h3>
                  <p class="adminui-help" style="font-size:0.9rem; margin-bottom:16px;">
                    Dessa prompts styr hur AI:n formulerar analyserna baserat p√• testdata,
                    intervjuanteckningar, betyg och dina skaldefinitioner.
                    <br>
                    Anpassa ton, l√§ngd och detaljer efter vad du vill att Julia AI ska ge f√∂r typ av output.
                  </p>

                  {% for prompt in prompts %}
                    {% if prompt.name not in "tolka_excel_resultat betygsskala_forklaring" %}
                      <div style="margin-bottom:24px;">
                        <label for="prompt_{{ prompt.name }}" class="adminui-label">
                          {{ prompt.name|capfirst }}
                        </label>
                        <p style="font-size:0.8rem; color:#666; margin-bottom:4px;">
                          Beh√•ll relevanta taggar (t.ex.
                          <code>{intervju_text}</code>,
                          <code>{ratings_json}</code>,
                          <code>{betygsskala_forklaring}</code>).
                        </p>
                        <textarea
                          id="prompt_{{ prompt.name }}"
                          name="prompt_{{ prompt.name }}"
                          rows="6"
                          class="adminui-textarea"
                        >{{ prompt.text }}</textarea>
                      </div>
                    {% endif %}
                  {% endfor %}
                </div>

                <button type="submit" class="adminui-button">
                  üíæ Spara √§ndringar
                </button>
              </form>

            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- H√ñGERSPALT -->
    <aside class="right-panel">
        <h3 class="assistant-title">Tillg√§ngliga taggar</h3>
        <p class="assistant-help adminui-intro">
          Klistra in dessa i dina prompts d√§r du vill att data ska ers√§ttas automatiskt.
        </p>

  <h3 class="assistant-title">Grunddata</h3>

    <div class="tag-box">
        <div class="tag-box-left">
            <code>{excel_text}</code>
            <p>R√•data fr√•n excel. Anv√§nd ej.</p>
        </div>

        <button class="tag-example-btn" data-modal="modal-excel">
            Se exempel
        </button>
    </div>

    <div class="tag-box">
        <div class="tag-box-left">
            <code>{ratings_json}</code>
            <p>St√§dad excel. Anv√§nd denna.</p>
        </div>

        <button class="tag-example-btn" data-modal="modal-ratings">
            Se exempel
        </button>
    </div>

    <div class="tag-box">
        <div class="tag-box-left">
            <code>{betygsskala_forklaring}</code>
            <p>Definition av niv√•erna</p>
        </div>

        <button class="tag-example-btn" data-modal="modal-betygsskala">
            Se exempel
        </button>
    </div>

    <div class="tag-box">
        <div class="tag-box-left">
            <code>{uploaded_files}</code>
            <p>Uppladdade CV:t</p>
        </div>

        <button class="tag-example-btn" data-modal="modal-cv">
            Se exempel
        </button>
    </div>

    <div class="tag-box">
        <div class="tag-box-left">
            <code>{intervju_text}</code>
            <p>Textbaserade anteckningar</p>
        </div>

        <button class="tag-example-btn" data-modal="modal-intervju">
            Se exempel
        </button>
    </div>

<br>
        <div class="assistant-section">
           <h3 class="assistant-title">Genererade taggar</h3>
          <p class="assistant-help adminui-intro">
            Dessa taggar f√•r sitt inneh√•ll under respektive steg i verktyget.
Det betyder att de bara fungerar i prompts som ligger efter det steg d√§r taggen genereras.
          </p>

    <div class="tag-box">
        <div class="tag-box-left">
            <code>{tq_fardighet_text}</code>
            <p>St√§dad resultat. Anv√§nd denna.</p>
        </div>
    </div>
    
    <div class="tag-box">
        <div class="tag-box-left">
            <code>{tq_motivation_text}</code>
            <p>St√§dad resultat. Anv√§nd denna.</p>
        </div>
    </div>
    
    <div class="tag-box">
        <div class="tag-box-left">
            <code>{leda_text}</code>
            <p>St√§dad resultat. Anv√§nd denna.</p>
        </div>
    </div>
    
    <div class="tag-box">
        <div class="tag-box-left">
            <code>{mod_text}</code>
            <p>St√§dad resultat. Anv√§nd denna.</p>
        </div>
    </div>
    
    <div class="tag-box">
        <div class="tag-box-left">
            <code>{sjalkannedom_text}</code>
            <p>St√§dad resultat. Anv√§nd denna.</p>
        </div>
    </div>
    
    <div class="tag-box">
        <div class="tag-box-left">
            <code>{strategi_text}</code>
            <p>St√§dad resultat. Anv√§nd denna.</p>
        </div>
    </div>
    
    <div class="tag-box">
        <div class="tag-box-left">
            <code>{kommunikation_text}</code>
            <p>St√§dad resultat. Anv√§nd denna.</p>
        </div>
    </div>
    
    <div class="tag-box">
        <div class="tag-box-left">
            <code>{sur_text}</code>
            <p>Styrkor / Utvecklingsomr√•den / Riskbeteenden.</p>
        </div>
    </div>


          <ul class="assistant-list">
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{tq_fardighet_text}</code></span>
            </li>
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{tq_motivation_text}</code></span>
            </li>
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{leda_text}</code></span>
            </li>
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{mod_text}</code></span>
            </li>
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{sjalkannedom_text}</code></span>
            </li>
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{strategi_text}</code></span>
            </li>
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{kommunikation_text}</code></span>
            </li>
            <li class="assistant-list-item">
              <span class="assistant-label"><code>{sur_text}</code></span>
              <span class="assistant-value">Styrkor / Utvecklingsomr√•den / Riskbeteenden.</span>
            </li>
          </ul>
        </div>

        <p class="assistant-empty" style="margin-top:1rem;">
          Ta inte bort taggarna i klamrar om du vill att r√§tt info ska fyllas i automatiskt.
        </p>
    </aside>

  </div>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{% static 'js/script.js' %}"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
  
  // √ñppna popup
  document.querySelectorAll(".tag-example-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      const modalId = btn.dataset.modal;
      document.getElementById(modalId).classList.add("is-open");
    });
  });

  // St√§ng popup (alla st√§ng-knappar)
  document.querySelectorAll(".dn-modal-close").forEach(btn => {
    btn.addEventListener("click", () => {
      btn.closest(".dn-modal").classList.remove("is-open");
    });
  });

  // St√§ng popup genom att klicka p√• m√∂rka bakgrunden
  document.querySelectorAll(".dn-modal").forEach(modal => {
    modal.addEventListener("click", e => {
      if (e.target.classList.contains("dn-modal-backdrop")) {
        modal.classList.remove("is-open");
      }
    });
  });

});
  </script>

  <!-- ===== Popup: Excel ===== -->
<div id="modal-excel" class="dn-modal">
  <div class="dn-modal-backdrop"></div>
  <div class="dn-modal-content">
    <button type="button" class="dn-modal-close">√ó</button>
    <h3>Exempel: {excel_text}</h3>
    <div class="dn-modal-body">
      <pre>
First Name,Last Name,
Competency Score: Teamwork (STIVE),
Competency Score: Networking (STIVE),
Competency Score: Developing relationships (STIVE),
Competency Score: Understand the individual (STIVE),
Competency Score: Demonstrate self-awareness (STIVE),
Competency Score: Resilience (STIVE),
Competency Score: Plan and organise (STIVE),
Competency Score: Proactive delivery (STIVE),
Competency Score: Decision making (STIVE),
Competency Score: Understanding the organisation (STIVE),
Competency Score: Drive and appetite for learning (STIVE),
Competency Score: Analysis (STIVE)

Per,L,1.57,2.40,3.23,4.12,3.55,2.78,4.33,3.90,2.67,3.45,4.10,3.52,4.18

      </pre>
    </div>
  </div>
</div>

<!-- ===== Popup: Intervju ===== -->
<div id="modal-intervju" class="dn-modal">
  <div class="dn-modal-backdrop"></div>
  <div class="dn-modal-content">
    <button type="button" class="dn-modal-close">√ó</button>
    <h3>Exempel: {intervju_text}</h3>
    <div class="dn-modal-body">
      <pre>
<span style="color: red;"><b>Denna tagg blir <u>exakt</u> det anv√§ndaren klistrat in i textrutan f√∂r anteckningar. T ex: </b></span><br>
Kandidaten beskriver sig som driven och strukturerad.
Har lett tv√• team och ansvarat f√∂r onboarding.
Styrkor: analys, kommunikation.
Utmaningar: tidspress och snabba deadlines.
      </pre>
    </div>
  </div>
</div>

<!-- ===== Popup: CV ===== -->
<div id="modal-cv" class="dn-modal">
  <div class="dn-modal-backdrop"></div>
  <div class="dn-modal-content">
    <button type="button" class="dn-modal-close">√ó</button>
    <h3>Exempel: {uploaded_files}</h3>
    <div class="dn-modal-body">
      <pre><br>
<span style="color: red;"><b>Denna tagg fylls med den text som h√§mtas ur CV-PDF:en som laddas upp. 
Endast texten tas med ‚Äì inga visuella element eller layout. T ex: </b></span><br>
Emma Lindstrom
emmalindstrom@example.com | +46 70 123 45 67 | Stockholm, Sweden

Professional Summary
Emma Lindstrom √§r en erfaren digital marknadsf√∂ringsspecialist med √∂ver 7 √•rs erfarenhet inom SEO, 
inneh√•llsstrategi och sociala medier. Emma √§r k√§nd f√∂r att √∂ka organisk trafik och utveckla h√∂gpresterande digitala kampanjer.

Work Experience
Senior Digital Marketing Specialist
Nordic Web Solutions, Stockholm
Jan 2020 - Present
- Emma ledde SEO-strategin som √∂kade webbplatstrafiken med 65% p√• 18 m√•nader. - Hon hanterade sociala 
mediekampanjer med √∂ver 100k f√∂ljare. - Emma samarbetade med produkt- och f√∂rs√§ljningsteam f√∂r att samordna budskap.

Marketing Coordinator
Bright Ideas AB, Malm√∂
Aug 2016 - Dec 2019
- Emma utvecklade inneh√•llsstrategier och √∂vervakade inneh√•llsskapande. - Hon skapade 
e-postmarknadsf√∂ringskampanjer med en genomsnittlig √∂ppningsfrekvens p√• 25%. - Emma genomf√∂rde
marknadsunders√∂kningar f√∂r att st√∂dja produktlanseringar.

Education
MSc in Marketing and Management
Lund University, 2014 - 2016

BSc in Business Administration
Uppsala University, 2011 - 2014

Skills
SEO & SEM
Google Analytics & Ads
Social Media Management
Content Strategy
WordPress & CMS
Adobe Photoshop & Illustrator
Languages
Swedish (Native)
English (Fluent)
Spanish (Intermediate)
      </pre>
    </div>
  </div>
</div>

<!-- ===== Popup: Ratings JSON ===== -->
<div id="modal-ratings" class="dn-modal">
  <div class="dn-modal-backdrop"></div>
  <div class="dn-modal-content">
    <button type="button" class="dn-modal-close">√ó</button>
    <h3>Exempel: {ratings_json}</h3>
    <div class="dn-modal-body">
      <pre><br>
<h2 class="adminui-title"><strong>Leda, utveckla och engagera</strong></h2>
<b>Leda andra:</b> 3
<b>Engagera andra:</b> 4
<b>Delegera:</b> 4
<b>Utveckla andra:</b> 2
<br>
<h2 class="adminui-title"><strong>Mod och handlingskraft</strong></h2>
<b>Beslutsamhet:</b> 5
<b>Integritet:</b> 2
<b>Hantera konflikter:</b> 1
<br>
<h2 class="adminui-title"><strong>Sj√§lvk√§nnedom och emotionell stabilitet</strong></h2>
<b>Sj√§lvmedvetenhet:</b> 3
<b>Uth√•llighet:</b> 4
<br>
<h2 class="adminui-title"><strong>Strategiskt t√§nkande och anpassningsf√∂rm√•ga</strong></h2>
<b>Strategiskt fokus:</b> 2
<b>Anpassningsf√∂rm√•ga:</b> 3
<br>
<h2 class="adminui-title"><strong>Kommunikation och samarbete</strong></h2>
<b>Teamarbete:</b> 3
<b>Inflytelserik:</b> 1
<br>
      </pre>
    </div>
  </div>
</div>

<!-- ===== Popup: Betygsskala ===== -->
<div id="modal-betygsskala" class="dn-modal">
  <div class="dn-modal-backdrop"></div>
  <div class="dn-modal-content">
    <button type="button" class="dn-modal-close">√ó</button>
    <h3>Exempel: {betygsskala_forklaring}</h3>
    <div class="dn-modal-body">
      <pre>
<span style="color: red;"><b>Denna tagg blir <u>exakt</u> det du skrivit i textrutan f√∂r "2. Betygsskala: Vad betyder niv√•erna 1‚Äì5?". T ex:</b></span><br>
1 = Tydligt utvecklingsomr√•de. Beteendet st√∂djer inte kraven i rollen.
2 = Acceptabel niv√•, men med tydliga utvecklingsbehov i mer komplexa situationer.
3 = God niv√•. R√§cker f√∂r de flesta vardagliga krav.
4 = Stark niv√•. Personen visar ofta beteenden som st√∂djer rollen v√§l.
5 = Mycket stark niv√•. Personen ligger konsekvent h√∂gt och fungerar som f√∂rebild.
      </pre>
    </div>
  </div>
</div>

</body>
</html>
